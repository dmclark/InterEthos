<% @title = 'New Category' %>

<% form_for(@category) do |f| %>
  <%= f.error_messages %>

  <p><%= label(:ontology, :id, 'Ontology') %><br />
    <strong><%= @ontology.name %></strong>
    <%= hidden_field_tag("category[ontology_id]", @ontology.id) %>
  </p>

  <%= hidden_field_tag("category[translation_id]", params[:translation_id]) %>

  <% if params[:parent_id] != 0 %>
    <%= hidden_field_tag("category[parent_id]", params[:parent_id]) %>
  <% else %>
    <p>
      <%= f.label :parent_category %><br />
      <%= tree_select(Category.find(:all, :conditions => "parent_id = 1"), 'category', 'parent_id', @category.parent_id) %>
    </p>
  <% end %>

  <p><%= f.label :category_name %><br />
    <% if params[:parent_id] == 0 %>
      <%= text_field_tag("category[name]", @ontology.name) %><br />
      <%= indent %><strong>Special:</strong> <em>You are about to set the top-level Category for your new Ontology.<br />
      <%= indent %><%= indent %>There can only be one top-level Category for an Ontology.<br />
      <%= indent %><%= indent %>It should be given a name that is similar to the name of the Ontology.<br />
      <%= indent %><%= indent %>So we have entered that name above.</em>
    <% else %>
      <%= f.text_field :name %>
    <% end %>
  </p>

  <p><%= f.label :category_meta %><br />
    <%= f.text_area :meta, :rows => 4, :cols => 45 %></p>
  
  <%= hidden_field_tag("category[user_id]", current_user.id) %>

  <% if params[:parent_id] != 0 && @translation_id == 0 %>
    <p><%= f.label "add similar" %><br />
      <%= check_box_tag 'add_similar' %></p>
  <% end %>
  
  <p><%= f.submit 'Create' %></p>

<% end %>

<%= link_to 'Back', ontology_path(@ontology.id) %>
<%= javascript_tag "$('category_name').focus()" %>